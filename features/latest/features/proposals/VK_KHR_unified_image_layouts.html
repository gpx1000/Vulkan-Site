<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>VK_KHR_unified_image_layouts :: Vulkan Documentation Project</title>
    <meta name="generator" content="Antora 3.1.10">
    <script>
      !function (theme) {
        if (theme === 'dark') document.documentElement.classList.add('dark')
        else document.documentElement.classList.add('light')
      }(localStorage && localStorage.getItem('theme') || (matchMedia('(prefers-color-scheme: dark)')?.matches && 'dark'))
    </script>
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <link rel="stylesheet" href="../../../../_/css/vendor/tabs.css">
    <link rel="apple-touch-icon" sizes="180x180" href="../../../../_/img/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="../../../../_/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="../../../../_/img/favicon-16x16.png">
    <link rel="manifest" href="../../../../_/site.webmanifest">
    <link rel="mask-icon" href="../../../../_/img/safari-pinned-tab.svg" color="#a41e22">
    <meta name="msapplication-TileColor" content="#ffc40d">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../.."><img class="navbar-item" alt="Vulkan White Label" src="../../../../_/Vulkan_Docs.svg" /></a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field has-filter">
          <label for="search-input"></label>
          <input id="search-input" type="text" placeholder="Search the docs">
          <label class="filter checkbox">
            <input type="checkbox" data-facet-filter="component:features" checked> In this component
          </label>
        </div>
      </div>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <!-- <a class="navbar-item" href="#">Home</a> -->
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Specs</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../../spec/latest/chapters/introduction.html">Vulkan API</a>
            <a class="navbar-item" href="../../../../glsl/latest/index.html">GLSL</a>
            <a class="navbar-item" href="../../../../guide/latest/hlsl.html">HLSL</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Education</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../../refpages/latest/refpages/index.html">Vulkan Reference Pages</a>
            <a class="navbar-item" href="../../../../features/latest/features/index.html">Vulkan Feature Descriptions</a>
            <a class="navbar-item" href="../../../../guide/latest/index.html">Vulkan Guide</a>
            <a class="navbar-item" href="../../../../samples/latest/README.html">Vulkan Samples</a>
            <a class="navbar-item" href="../../../../tutorial/latest/index.html">Vulkan Tutorial</a>
            <a class="navbar-item" href="https://www.youtube.com/c/vulkan">YouTube</a>
            <a class="navbar-item" href="https://vulkan.org">More Info at Vulkan.org</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Feedback</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://github.com/KhronosGroup/Vulkan-Site/issues/new/choose" target="_blank">Report a Problem</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Community</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://discord.gg/vulkan">Vulkan Discord</a>
            <a class="navbar-item" href="https://reddit.com/r/vulkan">Reddit</a>
            <a class="navbar-item" href="https://stackoverflow.com/questions/tagged/vulkan">Stack Overflow</a>
            <a class="navbar-item" href="https://fosstodon.org/@vulkan">Mastodon</a>
          </div>
        </div>
      </div>
    </div>
    <label class="theme-toggler">
      <input type="checkbox" id="switch-theme-checkbox" name="switch-theme-checkbox"/>
      <span class="icon"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="moon" class="svg-inline--fa fa-moon moon" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path fill="currentColor" d="M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"></path>
        </svg>
        <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="sun" class="svg-inline--fa fa-sun sun" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M361.5 1.2c5 2.1 8.6 6.6 9.6 11.9L391 121l107.9 19.8c5.3 1 9.8 4.6 11.9 9.6s1.5 10.7-1.6 15.2L446.9 256l62.3 90.3c3.1 4.5 3.7 10.2 1.6 15.2s-6.6 8.6-11.9 9.6L391 391 371.1 498.9c-1 5.3-4.6 9.8-9.6 11.9s-10.7 1.5-15.2-1.6L256 446.9l-90.3 62.3c-4.5 3.1-10.2 3.7-15.2 1.6s-8.6-6.6-9.6-11.9L121 391 13.1 371.1c-5.3-1-9.8-4.6-11.9-9.6s-1.5-10.7 1.6-15.2L65.1 256 2.8 165.7c-3.1-4.5-3.7-10.2-1.6-15.2s6.6-8.6 11.9-9.6L121 121 140.9 13.1c1-5.3 4.6-9.8 9.6-11.9s10.7-1.5 15.2 1.6L256 65.1 346.3 2.8c4.5-3.1 10.2-3.7 15.2-1.6zM160 256a96 96 0 1 1 192 0 96 96 0 1 1 -192 0zm224 0a128 128 0 1 0 -256 0 128 128 0 1 0 256 0z"></path>
        </svg></span>
    </label>
  </nav>
</header>
<script>
  window.onload = function() {
    let e = document.getElementById("switch-theme-checkbox")
    e.checked = document.documentElement.classList.contains("dark");
    e.checked ? e.parentElement.classList.add("active") : e.parentElement.classList.remove("active")
  }
  !function() {
    let e = document.getElementById("switch-theme-checkbox")
    e.checked = document.documentElement.classList.contains("dark")
    e.addEventListener("change", function() {
      if (document.documentElement.classList.contains("light")) {
        document.documentElement.classList.remove("light")
        document.documentElement.classList.add("dark")
      } else if (document.documentElement.classList.contains("dark")) {
        document.documentElement.classList.remove("dark")
        document.documentElement.classList.add("light")
      } else {
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
          document.documentElement.classList.add("dark")
        } else {
          document.documentElement.classList.add("light")
        }
      }
      document.documentElement.setAttribute("data-theme", this.checked ? "dark" : "light"),
        function(e) {
          window.localStorage && window.localStorage.setItem("theme", e)
        }(this.checked ? "dark" : "light"), this.checked ? this.parentElement.classList.add("active") : this.parentElement.classList.remove("active")
    }.bind(e))
  }();
</script>
<div class="body">
<div class="nav-container" data-component="features" data-version="latest" id="split-0">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">Vulkan Feature Descriptions</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">Vulkan Roadmap and Feature Descriptions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Roadmap.html">Vulkan Roadmap</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Feature Descriptions</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_AMDX_dense_geometry_format.html">VK_AMDX_dense_geometry_format</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_AMDX_shader_enqueue.html">VK_AMDX_shader_enqueue</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_AMD_anti_lag.html">VK_AMD_anti_lag</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_AMD_shader_early_and_late_fragment_tests.html">VK_AMD_shader_early_and_late_fragment_tests</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_ANDROID_external_format_resolve.html">VK_ANDROID_external_format_resolve</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_ARM_performance_counters_by_region.html">VK_ARM_performance_counters_by_region</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_ARM_pipeline_opacity_micromap.html">VK_ARM_pipeline_opacity_micromap</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_ARM_render_pass_striped.html">VK_ARM_render_pass_striped</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_ARM_tensors.html">VK_ARM_tensors</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_attachment_feedback_loop_dynamic_state.html">VK_EXT_attachment_feedback_loop_dynamic_state</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_attachment_feedback_loop_layout.html">VK_EXT_attachment_feedback_loop_layout</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_calibrated_timestamps.html">VK_EXT_calibrated_timestamps</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_custom_resolve.html">VK_EXT_custom_resolve</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_depth_bias_control.html">VK_EXT_depth_bias_control</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_depth_clamp_control.html">VK_EXT_depth_clamp_control</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_descriptor_buffer.html">VK_EXT_descriptor_buffer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_device_fault.html">VK_EXT_device_fault</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_device_generated_commands.html">VK_EXT_device_generated_commands</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_dynamic_rendering_unused_attachments.html">VK_EXT_dynamic_rendering_unused_attachments</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_extended_dynamic_state3.html">VK_EXT_extended_dynamic_state3</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_external_memory_acquire_unmodified.html">VK_EXT_external_memory_acquire_unmodified</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_external_memory_metal.html">VK_EXT_external_memory_metal</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_fragment_density_map_offset.html">VK_EXT_fragment_density_map_offset</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_frame_boundary.html">Proposal: <code>VK_EXT_frame_boundary</code></a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_graphics_pipeline_library.html">VK_EXT_graphics_pipeline_library</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_host_image_copy.html">VK_EXT_host_image_copy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_image_2d_array_of_3d.html">VK_EXT_image_2d_array_of_3d</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_image_compression_control.html">VK_EXT_image_compression_control</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_image_sliced_view_of_3d.html">VK_EXT_image_sliced_view_of_3d</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_layer_settings.html">VK_EXT_layer_settings</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_legacy_dithering.html">VK_EXT_legacy_dithering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_legacy_vertex_attributes.html">VK_EXT_legacy_vertex_attributes</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_map_memory_placed.html">VK_EXT_map_memory_placed</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_memory_decompression.html">VK_EXT_memory_decompression</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_mesh_shader.html">VK_EXT_mesh_shader</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_metal_objects.html">VK_EXT_metal_objects</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_multisampled_render_to_single_sampled.html">VK_EXT_multisampled_render_to_single_sampled</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_mutable_descriptor_type.html">VK_EXT_mutable_descriptor_type</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_non_seamless_cube_map.html">VK_EXT_non_seamless_cube_map</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_opacity_micromap.html">VK_EXT_opacity_micromap</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_pipeline_library_group_handles.html">VK_EXT_pipeline_library_group_handles</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_pipeline_protected_access.html">VK_EXT_pipeline_protected_access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_present_mode_fifo_latest_ready.html">VK_EXT_present_mode_fifo_latest_ready</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_present_timing.html">VK_EXT_present_timing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_primitives_generated_query.html">VK_EXT_primitives_generated_query</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_rasterization_order_attachment_access.html">VK_EXT_rasterization_order_attachment_access</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_ray_tracing_invocation_reorder.html">VK_EXT_ray_tracing_invocation_reorder</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_shader_64bit_indexing.html">VK_EXT_shader_64bit_indexing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_shader_float8.html">VK_EXT_shader_float8</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_shader_module_identifier.html">VK_EXT_shader_module_identifier</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_shader_object.html">VK_EXT_shader_object</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_shader_replicated_composites.html">VK_EXT_shader_replicated_composites</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_shader_tile_image.html">VK_EXT_shader_tile_image</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_shader_uniform_buffer_unsized_array.html">VK_EXT_shader_uniform_buffer_unsized_array</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_subpass_merge_feedback.html">VK_EXT_subpass_merge_feedback</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_surface_maintenance1.html">VK_EXT_surface_maintenance1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_swapchain_maintenance1.html">VK_EXT_swapchain_maintenance1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_EXT_zero_initialize_device_memory.html">VK_EXT_zero_initialize_device_memory</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_GOOGLE_surfaceless_query.html">VK_GOOGLE_surfaceless_query</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_HUAWEI_cluster_culling_shader.html">VK_HUAWEI_cluster_culling_shader</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_HUAWEI_invocation_mask.html">VK_HUAWEI_invocation_mask</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_compute_shader_derivatives.html">VK_KHR_compute_shader_derivatives</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_cooperative_matrix.html">VK_KHR_cooperative_matrix</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_copy_memory_indirect.html">VK_KHR_copy_memory_indirect</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_dynamic_rendering.html">VK_KHR_dynamic_rendering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_dynamic_rendering_local_read.html">VK_KHR_dynamic_rendering_local_read</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_fragment_shader_barycentric.html">VK_KHR_fragment_shader_barycentric</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_fragment_shading_rate.html">VK_KHR_fragment_shading_rate</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_load_store_op_none.html">VK_KHR_load_store_op_none</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_maintenance10.html">VK_KHR_maintenance10</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_maintenance5.html">VK_KHR_maintenance5</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_maintenance6.html">VK_KHR_maintenance6</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_maintenance7.html">VK_KHR_maintenance7</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_maintenance8.html">VK_KHR_maintenance8</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_maintenance9.html">VK_KHR_maintenance9</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_map_memory2.html">VK_KHR_map_memory2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_pipeline_binary.html">VK_KHR_pipeline_binary</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_present_id2.html">VK_KHR_present_id2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_present_mode_fifo_latest_ready.html">VK_KHR_present_mode_fifo_latest_ready</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_present_wait2.html">VK_KHR_present_wait2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_ray_tracing_position_fetch.html">VK_KHR_ray_tracing_position_fetch</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_shader_bfloat16.html">VK_KHR_shader_bfloat16</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_shader_expect_assume.html">VK_KHR_shader_expect_assume</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_shader_float_controls2.html">VK_KHR_shader_float_controls2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_shader_fma.html">VK_KHR_shader_fma</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_shader_integer_dot_product.html">VK_KHR_shader_integer_dot_product</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_shader_maximal_reconvergence.html">VK_KHR_shader_maximal_reconvergence</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_shader_quad_control.html">VK_KHR_shader_quad_control</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_shader_relaxed_extended_instruction.html">VK_KHR_shader_relaxed_extended_instruction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_shader_subgroup_rotate.html">Subgroup rotation instruction</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_shader_untyped_pointers.html">VK_KHR_shader_untyped_pointers</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_surface_maintenance1.html">VK_KHR_surface_maintenance1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_swapchain_maintenance1.html">VK_KHR_swapchain_maintenance1</a>
  </li>
  <li class="nav-item is-current-page" data-depth="2">
    <a class="nav-link" href="VK_KHR_unified_image_layouts.html">VK_KHR_unified_image_layouts</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_vertex_attribute_divisor.html">VK_KHR_vertex_attribute_divisor</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_decode_av1.html">VK_KHR_video_decode_av1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_decode_h264.html">VK_KHR_video_decode_h264</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_decode_h265.html">VK_KHR_video_decode_h265</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_decode_queue.html">VK_KHR_video_decode_queue</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_decode_vp9.html">VK_KHR_video_decode_vp9</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_encode_av1.html">VK_KHR_video_encode_av1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_encode_h264.html">VK_KHR_video_encode_h264</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_encode_h265.html">VK_KHR_video_encode_h265</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_encode_intra_refresh.html">VK_KHR_video_encode_intra_refresh</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_encode_quantization_map.html">VK_KHR_video_encode_quantization_map</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_encode_queue.html">VK_KHR_video_encode_queue</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_maintenance1.html">VK_KHR_video_maintenance1</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_maintenance2.html">VK_KHR_video_maintenance2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_KHR_video_queue.html">VK_KHR_video_queue</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_LUNARG_direct_driver_loading.html">VK_LUNARG_direct_driver_loading</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_MSFT_layered_driver.html">VK_MSFT_layered_driver</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_NV_cluster_acceleration_structure.html">VK_NV_cluster_acceleration_structure</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_NV_cooperative_matrix2.html">VK_NV_cooperative_matrix2</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_NV_cooperative_vector.html">VK_NV_cooperative_vector</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_NV_display_stereo.html">VK_NV_display_stereo</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_NV_external_compute_queue.html">VK_NV_external_compute_queue</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_NV_partitioned_acceleration_structure.html">VK_NV_partitioned_acceleration_structure</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_NV_ray_tracing_linear_swept_spheres.html">VK_NV_ray_tracing_linear_swept_spheres</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_NV_ray_tracing_validation.html">VK_NV_ray_tracing_validation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_QCOM_data_graph_model.html">VK_QCOM_data_graph_model</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_QCOM_image_processing.html">VK_QCOM_image_processing</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_QCOM_tile_memory_heap.html">VK_QCOM_tile_memory_heap</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_QCOM_tile_properties.html">VK_QCOM_tile_properties</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_QCOM_tile_shading.html">VK_QCOM_tile_shading</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VK_VERSION_1_4.html">Vulkan 1.4</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="VulkanBase.html">Vulkan Base</a>
  </li>
</ul>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Vulkan Feature Descriptions</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../../../../tutorial/latest/00_Introduction.html">Khronos Vulkan Tutorial</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../tutorial/latest/00_Introduction.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../../glsl/latest/index.html">OpenGL Shading Language Specification</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../glsl/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../../refpages/latest/refpages/index.html">Vulkan API Reference Pages</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../refpages/latest/refpages/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <div class="title"><a href="../index.html">Vulkan Feature Descriptions</a></div>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../../guide/latest/index.html">Vulkan Guide</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../guide/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../../samples/latest/README.html">Vulkan Samples</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../samples/latest/README.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../../../spec/latest/index.html">Vulkan Specification</a></div>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../spec/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article" id="split-1">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../spec/latest/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Vulkan Feature Descriptions</a></li>
    <li>Feature Descriptions</li>
    <li><a href="VK_KHR_unified_image_layouts.html">VK_KHR_unified_image_layouts</a></li>
  </ul>
</nav>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">VK_KHR_unified_image_layouts</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_problem_statement">1. Problem Statement</a></li>
<li><a href="#_solution_space">2. Solution Space</a></li>
<li><a href="#_proposal">3. Proposal</a>
<ul class="sectlevel2">
<li><a href="#_replacing_transition_out_of_vk_image_layout_undefined">3.1. Replacing Transition Out Of <code>VK_IMAGE_LAYOUT_UNDEFINED</code></a></li>
<li><a href="#_replacing_vk_image_layout_preinitialized">3.2. Replacing <code>VK_IMAGE_LAYOUT_PREINITIALIZED</code></a></li>
<li><a href="#_replacing_vk_image_layout_attachment_feedback_loop_optimal_ext">3.3. Replacing <code>VK_IMAGE_LAYOUT_ATTACHMENT_FEEDBACK_LOOP_OPTIMAL_EXT</code></a></li>
<li><a href="#_replacing_vk_image_layout_present_src_khr_and_vk_image_layout_shared_present_khr">3.4. Replacing <code>VK_IMAGE_LAYOUT_PRESENT_SRC_KHR</code> and <code>VK_IMAGE_LAYOUT_SHARED_PRESENT_KHR</code></a></li>
<li><a href="#_replacing_vulkan_video_layouts">3.5. Replacing Vulkan Video Layouts</a></li>
</ul>
</li>
<li><a href="#_issues">4. Issues</a>
<ul class="sectlevel2">
<li><a href="#_resolved_can_vk_image_layout_undefined_be_avoided_in_this_extension">4.1. Resolved: Can <code>VK_IMAGE_LAYOUT_UNDEFINED</code> be avoided in this extension?</a></li>
<li><a href="#_resolved_should_vk_image_layout_preinitialized_be_replaced_by_vk_image_layout_general">4.2. Resolved: Should <code>VK_IMAGE_LAYOUT_PREINITIALIZED</code> be replaced by <code>VK_IMAGE_LAYOUT_GENERAL</code>?</a></li>
<li><a href="#_resolved_should_vk_image_layout_present_src_khr_be_replaced_by_vk_image_layout_general_and_a_queue_family_ownership_transfer">4.3. Resolved: Should <code>VK_IMAGE_LAYOUT_PRESENT_SRC_KHR</code> be replaced by <code>VK_IMAGE_LAYOUT_GENERAL</code> and a queue family ownership transfer?</a></li>
<li><a href="#_resolved_can_vk_image_layout_shared_present_khr_be_replaced_by_vk_image_layout_general">4.4. Resolved: Can <code>VK_IMAGE_LAYOUT_SHARED_PRESENT_KHR</code> be replaced by <code>VK_IMAGE_LAYOUT_GENERAL</code>?</a></li>
<li><a href="#_resolved_can_the_vulkan_video_layouts_be_replaced_by_vk_image_layout_general">4.5. Resolved: Can the Vulkan Video layouts be replaced by <code>VK_IMAGE_LAYOUT_GENERAL</code>?</a></li>
<li><a href="#_resolved_can_vk_image_layout_attachment_feedback_loop_optimal_ext_be_replaced_by_vk_image_layout_general">4.6. Resolved: Can <code>VK_IMAGE_LAYOUT_ATTACHMENT_FEEDBACK_LOOP_OPTIMAL_EXT</code> be replaced by <code>VK_IMAGE_LAYOUT_GENERAL</code>?</a></li>
<li><a href="#_resolved_should_image_layouts_in_the_api_be_ignored_required_to_be_vk_image_layout_general_or_simply_provide_the_possibility_of_that_layout_and_a_guarantee_of_efficiency">4.7. Resolved: Should image layouts in the API be <em>ignored</em>, <em>required</em> to be <code>VK_IMAGE_LAYOUT_GENERAL</code>, or simply provide the possibility of that layout and a guarantee of efficiency?</a></li>
</ul>
</li>
</ul>
</div>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This extension significantly simplifies synchronization in Vulkan by removing the need for image layout transitions.
In particular, it guarantees that using the <code>VK_IMAGE_LAYOUT_GENERAL</code> layout everywhere possible is just as efficient as using the other layouts.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_problem_statement"><a class="anchor" href="#_problem_statement"></a>1. Problem Statement</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is well-known that synchronization in Vulkan can be complicated.
While there are many aspects to that complication, the focus of this proposal is on image layouts.
In particular, a non-trivial subset of applications are unable to predict the exact layout of images before they are used.
This leads to complications such as deferring work until those layouts are known, or resorting to recording tiny command buffers before making a submission to adjust layouts as belatedly determined.</p>
</div>
<div class="paragraph">
<p>In practice, most of the image layouts are actually identical for most drivers.
For some drivers, they are <em>all</em> identical.
This renders the complications facing the applications superficial and the lengths they go through to satisfy Vulkan&#8217;s rules unnecessary.
Currently, applications are unable to tell when image layouts matter.</p>
</div>
<div class="paragraph">
<p>This proposal sets out to simplify Vulkan&#8217;s synchronization and alleviate this problem for Vulkan developers.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_solution_space"><a class="anchor" href="#_solution_space"></a>2. Solution Space</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are a number of ways unnecessary image layout transitions can be avoided:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Expose the necessary information, such as which layouts are physically identical, through queries.
This approach has the downside that it introduces even more complexity without effectively removing any as the fall back paths still need to implement the original algorithms.</p>
</li>
<li>
<p>Provide assistance from the drivers, for example to perform image layout transitions automatically as needed.
This approach simplifies the application, but is fraught with risks.
In particular, a risk of over-synchronization and resorting to guess-work if the driver is unable to derive the complete intention of the application.</p>
</li>
<li>
<p>Remove image layouts altogether.
This is ideal, but simply not possible on hardware that truly differentiates between some image layouts.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_proposal"><a class="anchor" href="#_proposal"></a>3. Proposal</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the interest of simplifying synchronization in Vulkan, this extension implements the latter solution, removing image layouts altogether as much as possible.
As such, this extension is fairly simple.</p>
</div>
<div class="paragraph">
<p>It is understood and accepted that some hardware architectures need to be modified to accommodate for this extension.</p>
</div>
<div class="paragraph">
<p>The <code>unifiedImageLayouts</code> feature indicates that image layouts are, barring a few exceptions, effectively all identical, that image layout transitions between them are unnecessary, and the functionality of this extension is available:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c hljs" data-lang="c">typedef struct VkPhysicalDeviceUnifiedImageLayoutsFeaturesKHR {
    VkStructureType    sType;
    void*              pNext;
    VkBool32           unifiedImageLayouts;
    VkBool32           unifiedImageLayoutsVideo;
} VkPhysicalDeviceUnifiedImageLayoutsFeaturesKHR;</code></pre>
</div>
</div>
<div class="paragraph">
<p>See below regarding <code>unifiedImageLayoutsVideo</code>.</p>
</div>
<div class="paragraph">
<p>The application is thus allowed to use <code>VK_IMAGE_LAYOUT_GENERAL</code> where most other layouts are allowed, including a few layouts where <code>VK_IMAGE_LAYOUT_GENERAL</code> was previously not allowed, and expect optimal performance.
The application then has a choice of using image or global memory barriers where image layout transitions were previously required.
Using global barriers may be simpler for some applications, but image barriers are still required for best performance on some hardware, even if both src and dst layouts are <code>VK_IMAGE_LAYOUT_GENERAL</code>.</p>
</div>
<div class="paragraph">
<p>The application is not forbidden from issuing image layout transitions or using the other layouts.
In particular, this is to support using helper libraries that are not aware of this extension.</p>
</div>
<div class="paragraph">
<p>Some exceptional situations exist, for example where an existing layout enum carries more information than just the layout itself:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_IMAGE_LAYOUT_UNDEFINED</code> when creating an image, and in image layout transitions away from it.
This "image layout" is necessary for the purpose of initializing the image metadata.
Additionally, it is useful for communicating that the previous contents of the memory bound to the image can be discarded.</p>
</li>
<li>
<p><code>VK_IMAGE_LAYOUT_PREINITIALIZED</code> when creating an image.
This image layout is identical to <code>VK_IMAGE_LAYOUT_GENERAL</code> in this extension, but <code>VK_IMAGE_LAYOUT_GENERAL</code> is <em>not</em> allowed when creating an image.
This is to remove any chance of mistakes where <code>VK_IMAGE_LAYOUT_GENERAL</code> is used in place of <code>VK_IMAGE_LAYOUT_UNDEFINED</code> with no following layout transition (or equivalent), which would be invalid.
Furthermore, it is expected that usage of <code>VK_IMAGE_LAYOUT_PREINITIALIZED</code> is rare, and that <code>VK_EXT_host_image_copy</code> supersedes usage of that layout in most cases.</p>
</li>
<li>
<p><code>VK_IMAGE_LAYOUT_ATTACHMENT_FEEDBACK_LOOP_OPTIMAL_EXT</code>.
While hardware revisions are expected to make this layout obsolete, a special consideration for it allows some existing hardware to expose this extension.
A render pass attachment flag to indicate feedback loop would also help simplify feedback loop rules and validation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In some other cases, the layout enum signifies interactions with other non-Vulkan APIs and entities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>VK_IMAGE_LAYOUT_PRESENT_SRC_KHR</code> and <code>VK_IMAGE_LAYOUT_SHARED_PRESENT_KHR</code>.
These layouts <em>are</em> different from <code>VK_IMAGE_LAYOUT_GENERAL</code>, due to interaction with components outside of Vulkan, namely the operating system&#8217;s compositor.
In reality, transitions to and from this layout are better represented as queue family ownership transfer operations.</p>
</li>
<li>
<p>Certain Vulkan Video layouts.
Similarly to <code>VK_IMAGE_LAYOUT_PRESENT_SRC_KHR</code>, some of the Vulkan Video image layouts are internally different from <code>VK_IMAGE_LAYOUT_GENERAL</code> because they interact with non-graphics components on the same chip or even outside of it.
While future hardware revisions may be able to reconcile this difference, it would be ideal for drivers to be able to support this extension sooner rather than later.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_replacing_transition_out_of_vk_image_layout_undefined"><a class="anchor" href="#_replacing_transition_out_of_vk_image_layout_undefined"></a>3.1. Replacing Transition Out Of <code>VK_IMAGE_LAYOUT_UNDEFINED</code></h3>
<div class="paragraph">
<p>An API can be conceived to initialize or reset the image metadata, to the same effect as transitioning out of <code>VK_IMAGE_LAYOUT_UNDEFINED</code>.
This is deferred to a future extension.</p>
</div>
<div class="paragraph">
<p>Applications are encouraged to still take advantage of <code>VK_IMAGE_LAYOUT_UNDEFINED</code> as some drivers are able to further optimize memory transactions accordingly.</p>
</div>
</div>
<div class="sect2">
<h3 id="_replacing_vk_image_layout_preinitialized"><a class="anchor" href="#_replacing_vk_image_layout_preinitialized"></a>3.2. Replacing <code>VK_IMAGE_LAYOUT_PREINITIALIZED</code></h3>
<div class="paragraph">
<p>This extension does not in fact allow <code>VK_IMAGE_LAYOUT_GENERAL</code> instead of this layout.
Rare applications that initialize the image memory and use this layout may continue to do so and issue an image layout transition afterwards to <code>VK_IMAGE_LAYOUT_GENERAL</code>.
The functionality of <code>VK_EXT_host_image_copy</code> should be used instead to pre-initialize image memory more efficiently.</p>
</div>
</div>
<div class="sect2">
<h3 id="_replacing_vk_image_layout_attachment_feedback_loop_optimal_ext"><a class="anchor" href="#_replacing_vk_image_layout_attachment_feedback_loop_optimal_ext"></a>3.3. Replacing <code>VK_IMAGE_LAYOUT_ATTACHMENT_FEEDBACK_LOOP_OPTIMAL_EXT</code></h3>
<div class="paragraph">
<p>This extension allows applications to use the <code>VK_IMAGE_LAYOUT_GENERAL</code> layout in place of <code>VK_IMAGE_LAYOUT_ATTACHMENT_FEEDBACK_LOOP_OPTIMAL_EXT</code>, but chain the following to <code>VkRenderingAttachmentInfo</code> to provide the same information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-c hljs" data-lang="c">typedef struct VkAttachmentFeedbackLoopInfoEXT {
    VkStructureType    sType;
    void*              pNext;
    VkBool32           feedbackLoopEnable;
} VkAttachmentFeedbackLoopInfoEXT;</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_replacing_vk_image_layout_present_src_khr_and_vk_image_layout_shared_present_khr"><a class="anchor" href="#_replacing_vk_image_layout_present_src_khr_and_vk_image_layout_shared_present_khr"></a>3.4. Replacing <code>VK_IMAGE_LAYOUT_PRESENT_SRC_KHR</code> and <code>VK_IMAGE_LAYOUT_SHARED_PRESENT_KHR</code></h3>
<div class="paragraph">
<p>The present engine is an entity external to Vulkan.
These layouts were added in Vulkan 1.0 to make images compatible with this entity.
Since then however, <code>VK_QUEUE_FAMILY_EXTERNAL</code> and <code>VK_QUEUE_FAMILY_FOREIGN_EXT</code> in <a href="https://docs.vulkan.org/spec/latest/chapters/synchronization.html#synchronization-queue-transfers">queue family ownership transfers</a> provided a better mechanism to interact with such external entities.
This extension does <em>not</em> remove these layouts, and redesigning the API around the interaction with the present engine is deferred to a future extension.</p>
</div>
</div>
<div class="sect2">
<h3 id="_replacing_vulkan_video_layouts"><a class="anchor" href="#_replacing_vulkan_video_layouts"></a>3.5. Replacing Vulkan Video Layouts</h3>
<div class="paragraph">
<p>Vulkan Video&#8217;s encode and decode operations are often performed by hardware units that are not unified with graphics and compute.
Support for using <code>VK_IMAGE_LAYOUT_GENERAL</code> for these layouts is indicated by the <code>unifiedImageLayoutsVideo</code> feature.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_issues"><a class="anchor" href="#_issues"></a>4. Issues</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_resolved_can_vk_image_layout_undefined_be_avoided_in_this_extension"><a class="anchor" href="#_resolved_can_vk_image_layout_undefined_be_avoided_in_this_extension"></a>4.1. Resolved: Can <code>VK_IMAGE_LAYOUT_UNDEFINED</code> be avoided in this extension?</h3>
<div class="paragraph">
<p>No.
An API was drafted to initialize the image metadata to this effect, but it did not materially simplify the extension.
A future extension that physically removes <code>VkImageLayout</code> values from the API would need such a replacement.
This work is deferred to that extension.</p>
</div>
</div>
<div class="sect2">
<h3 id="_resolved_should_vk_image_layout_preinitialized_be_replaced_by_vk_image_layout_general"><a class="anchor" href="#_resolved_should_vk_image_layout_preinitialized_be_replaced_by_vk_image_layout_general"></a>4.2. Resolved: Should <code>VK_IMAGE_LAYOUT_PREINITIALIZED</code> be replaced by <code>VK_IMAGE_LAYOUT_GENERAL</code>?</h3>
<div class="paragraph">
<p>No.
While <em>technically</em> replacing <code>VK_IMAGE_LAYOUT_PREINITIALIZED</code> with <code>VK_IMAGE_LAYOUT_GENERAL</code> during image creation would have worked, mistakenly using <code>VK_IMAGE_LAYOUT_GENERAL</code> instead of <code>VK_IMAGE_LAYOUT_UNDEFINED</code> would have been hard to catch in validation layers.
Ultimately, it was decided that <code>VK_IMAGE_LAYOUT_PREINITIALIZED</code> should practically be obsolete, and no provisions for it are needed in this extension.</p>
</div>
</div>
<div class="sect2">
<h3 id="_resolved_should_vk_image_layout_present_src_khr_be_replaced_by_vk_image_layout_general_and_a_queue_family_ownership_transfer"><a class="anchor" href="#_resolved_should_vk_image_layout_present_src_khr_be_replaced_by_vk_image_layout_general_and_a_queue_family_ownership_transfer"></a>4.3. Resolved: Should <code>VK_IMAGE_LAYOUT_PRESENT_SRC_KHR</code> be replaced by <code>VK_IMAGE_LAYOUT_GENERAL</code> and a queue family ownership transfer?</h3>
<div class="paragraph">
<p>No, not in this extension.
There are existing Vulkan layers that draw an overlay by intercepting the call to <code>vkQueuePresentKHR</code>.
For these layers to continue to work, the queue family ownership transfer to a special family for present engine must be "equivalent" to doing an image layout transition.
However, this can be very error-prone when multiple queues are involved, in particular because the layers cannot distinguish between an image that is in the <code>VK_IMAGE_LAYOUT_PRESENT_SRC_KHR</code> layout and one that is transferred to a special queue family.
A new <code>vkQueuePresent2KHR</code> entry point can resolve this, but it is needed for other work-in-progress extensions too.</p>
</div>
<div class="paragraph">
<p>It was ultimately decided that it is best to solve this problem in a separate extension.
Using the <code>VK_IMAGE_LAYOUT_PRESENT_SRC_KHR</code> layout is typically less cumbersome than the other layouts as it is normally only used at the boundary of interactions with the present engine.</p>
</div>
</div>
<div class="sect2">
<h3 id="_resolved_can_vk_image_layout_shared_present_khr_be_replaced_by_vk_image_layout_general"><a class="anchor" href="#_resolved_can_vk_image_layout_shared_present_khr_be_replaced_by_vk_image_layout_general"></a>4.4. Resolved: Can <code>VK_IMAGE_LAYOUT_SHARED_PRESENT_KHR</code> be replaced by <code>VK_IMAGE_LAYOUT_GENERAL</code>?</h3>
<div class="paragraph">
<p>No, not in this extension.
The driver has enough information at Vulkan swapchain creation to determine if the image needs to use a layout that can be shared with the present engine.
However, a complication involving <code>VkSurfacePresentModeCompatibilityEXT</code> from the <code>VK_EXT_surface_maintenance1</code> extension and <code>VkSwapchainPresentModesCreateInfoEXT</code> from the <code>VK_EXT_swapchain_maintenance1</code> extension exists.
If any shared present modes and non-shared present modes are declared compatible by the driver and subsequently used to create a swapchain, the lack of an image layout transition makes it impossible for the driver to use an efficient internal layout when the application switches from a shared present mode to a non-shared present mode.</p>
</div>
<div class="paragraph">
<p>At the time this extension was developed, changing present modes between shared and non-shared present modes did not actually have well-defined semantics and no existing driver actually considered the two sets compatible, but Vulkan did not specifically forbid it.
It was deemed preferable allow this compatibility and eventually define compatibility between these modes, implying that <code>VK_IMAGE_LAYOUT_SHARED_PRESENT_KHR</code> cannot yet be replaced with <code>VK_IMAGE_LAYOUT_GENERAL</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_resolved_can_the_vulkan_video_layouts_be_replaced_by_vk_image_layout_general"><a class="anchor" href="#_resolved_can_the_vulkan_video_layouts_be_replaced_by_vk_image_layout_general"></a>4.5. Resolved: Can the Vulkan Video layouts be replaced by <code>VK_IMAGE_LAYOUT_GENERAL</code>?</h3>
<div class="paragraph">
<p>Only optionally.
In the interest of alleviating developer pain sooner rather than later, and considering the fact that some significant classes of applications (such as video games) do not use Vulkan Video, it was decided to use an optional feature to indicate whether these layouts can be replaced with <code>VK_IMAGE_LAYOUT_GENERAL</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_resolved_can_vk_image_layout_attachment_feedback_loop_optimal_ext_be_replaced_by_vk_image_layout_general"><a class="anchor" href="#_resolved_can_vk_image_layout_attachment_feedback_loop_optimal_ext_be_replaced_by_vk_image_layout_general"></a>4.6. Resolved: Can <code>VK_IMAGE_LAYOUT_ATTACHMENT_FEEDBACK_LOOP_OPTIMAL_EXT</code> be replaced by <code>VK_IMAGE_LAYOUT_GENERAL</code>?</h3>
<div class="paragraph">
<p>Yes.
However, the information provided by this layout is necessary for some existing hardware to be able to expose this extension.
In the interest of allowing this extension to be supported on as much hardware as early as possible, this extension adds a boolean flag to render pass attachments to indicate whether they are to be used in feedback loops.</p>
</div>
<div class="paragraph">
<p>The purpose of this layout is for emulation of legacy APIs and as such is supposed to only be used by API layers.
Given the limited scope, and knowledge of existing layers, it was deemed sufficient to only add the aforementioned flag for dynamic rendering.</p>
</div>
</div>
<div class="sect2">
<h3 id="_resolved_should_image_layouts_in_the_api_be_ignored_required_to_be_vk_image_layout_general_or_simply_provide_the_possibility_of_that_layout_and_a_guarantee_of_efficiency"><a class="anchor" href="#_resolved_should_image_layouts_in_the_api_be_ignored_required_to_be_vk_image_layout_general_or_simply_provide_the_possibility_of_that_layout_and_a_guarantee_of_efficiency"></a>4.7. Resolved: Should image layouts in the API be <em>ignored</em>, <em>required</em> to be <code>VK_IMAGE_LAYOUT_GENERAL</code>, or simply provide the possibility of that layout and a guarantee of efficiency?</h3>
<div class="paragraph">
<p>Experience has shown that "ignored" parameters lead to complications and bugs in validation layers and implementations.
"Requiring" <code>VK_IMAGE_LAYOUT_GENERAL</code> has the downside that an existing library, unaware of this extension, can no longer be used if this extension is enabled.</p>
</div>
<div class="paragraph">
<p>Instead, this extensions adds the possibility for <code>VK_IMAGE_LAYOUT_GENERAL</code> to be used where it previously could not be (if possible), e.g. for feedback loop or video layouts.
Additionally, it guarantees that using this layout throughout the lifetime of the image is just as efficient as using the other layouts where possible.
Otherwise, this application functions in the existing synchronization framework of Vulkan, i.e. applications are free to use <code>VK_IMAGE_LAYOUT_GENERAL</code> or not as they see fit.</p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/vendor/split.js"></script>
<script>
    // Splitter should only be visible in non-mobile layouts (where a hamburger menu is used for nav)
    var width = (window.innerWidth > 0) ? window.innerWidth : screen.width;
    var mobileNav = (width < 1024);

    if (!mobileNav) {
        var sizes = localStorage.getItem('split-sizes')

        if (sizes) {
            sizes = JSON.parse(sizes)
        } else {
            sizes = [25, 75]
        }

        var split = Split(['#split-0', '#split-1'], {
            sizes: sizes,
            onDragEnd: function (sizes) {
                localStorage.setItem('split-sizes', JSON.stringify(sizes))
            },
        })
    }
</script>
<script src="../../../../_/js/vendor/lunr.js" defer></script>
<script src="https://cdn.jsdelivr.net/pako/1.0.3/pako.min.js" defer></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css" defer></script>
<script>
window.addEventListener('DOMContentLoaded', function(){
  try {
    var script = document.getElementById('search-ui-script');
    var siteRoot = (script && script.getAttribute('data-site-root-path')) || '';
    var manifestUrl = siteRoot + '/search-index/manifest.json';
    fetch(manifestUrl)
      .then(function (r) { return r.ok ? r.json() : Promise.reject(new Error('manifest not found')) })
      .then(function (manifest) { antoraSearch.bootstrap(lunr, manifest, siteRoot); })
      .catch(function () {
        var s = document.createElement('script');
        s.async = true;
        s.src = siteRoot + '/search-index.js';
        document.head.appendChild(s);
      });
  } catch (e) {
    // Fallback to monolithic index if anything goes wrong
    var s = document.createElement('script');
    s.async = true;
    s.src = '../../../../search-index.js';
    document.head.appendChild(s);
  }
});
</script>
<script async src="../../../../_/js/vendor/tabs.js"></script>
  </body>
</html>
