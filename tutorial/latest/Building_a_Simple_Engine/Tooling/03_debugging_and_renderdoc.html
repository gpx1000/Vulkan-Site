<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Tooling: Debugging with VK_KHR_debug_utils and RenderDoc :: Vulkan Documentation Project</title>
    <meta name="generator" content="Antora 3.1.10">
    <link rel="stylesheet" href="../../../../_/css/site.css">
    <script>var uiRootPath = '../../../../_'</script>
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="../../../..">Vulkan Documentation Project</a>
      <div class="navbar-item">
        <img alt="Vulkan White Label" src="../../../../_/Vulkan_White_Dec16.svg" height="100%" />
      </div>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <label for="search-input"></label><input id="search-input" type="text" placeholder="Search the docs">
        </div>
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <!-- <a class="navbar-item" href="#">Home</a> -->
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Specs</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../../spec/latest/chapters/introduction.html">Vulkan 1.3</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Guides</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../../guide/latest/index.html">Vulkan Guide</a>
          </div>
        </div>
            <!--
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Tools</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">TBD</a>
          </div>
        </div>
            -->
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Tutorial</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../../tutorial/latest/index.html">Vulkan Tutorial</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Samples</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="../../../../samples/latest/README.html">Vulkan Samples</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Help</a>
          <div class="navbar-dropdown is-right">
            <a class="navbar-item" href="https://discord.gg/vulkan">Vulkan Discord</a>
            <a class="navbar-item" href="https://khr.io/khrdiscord">Khronos Discord</a>
          </div>
        </div>
            <!--
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
            -->
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="tutorial" data-version="latest">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../../00_Introduction.html">Khronos Vulkan Tutorial</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../00_Introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../01_Overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../02_Development_environment.html">Development environment</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../03_Drawing_a_triangle/00_Setup/00_Base_code.html">Drawing a triangle</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../03_Drawing_a_triangle/00_Setup/00_Base_code.html">Setup</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../03_Drawing_a_triangle/00_Setup/00_Base_code.html">Base Code</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../03_Drawing_a_triangle/00_Setup/01_Instance.html">Instance</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../03_Drawing_a_triangle/00_Setup/02_Validation_layers.html">Validation layers</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../03_Drawing_a_triangle/00_Setup/03_Physical_devices_and_queue_families.html">Physical devices and queue families</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../03_Drawing_a_triangle/00_Setup/04_Logical_device_and_queues.html">Logical device and queues</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../03_Drawing_a_triangle/01_Presentation/00_Window_surface.html">Presentation</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../03_Drawing_a_triangle/01_Presentation/00_Window_surface.html">Window surface</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../03_Drawing_a_triangle/01_Presentation/01_Swap_chain.html">Swap chain</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../03_Drawing_a_triangle/01_Presentation/02_Image_views.html">Image views</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../03_Drawing_a_triangle/02_Graphics_pipeline_basics/00_Introduction.html">Graphics pipeline basics</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../03_Drawing_a_triangle/02_Graphics_pipeline_basics/00_Introduction.html">Introduction</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../03_Drawing_a_triangle/02_Graphics_pipeline_basics/01_Shader_modules.html">Shader modules</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../03_Drawing_a_triangle/02_Graphics_pipeline_basics/02_Fixed_functions.html">Fixed functions</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../03_Drawing_a_triangle/02_Graphics_pipeline_basics/03_Render_passes.html">Render passes</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../03_Drawing_a_triangle/02_Graphics_pipeline_basics/04_Conclusion.html">Conclusion</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../03_Drawing_a_triangle/03_Drawing/00_Framebuffers.html">Drawing</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../03_Drawing_a_triangle/03_Drawing/00_Framebuffers.html">Framebuffers</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../03_Drawing_a_triangle/03_Drawing/01_Command_buffers.html">Command buffers</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../03_Drawing_a_triangle/03_Drawing/02_Rendering_and_presentation.html">Rendering and presentation</a>
  </li>
  <li class="nav-item" data-depth="3">
    <a class="nav-link" href="../../03_Drawing_a_triangle/03_Drawing/03_Frames_in_flight.html">Frames in flight</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../03_Drawing_a_triangle/04_Swap_chain_recreation.html">Swap chain recreation</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../04_Vertex_buffers/00_Vertex_input_description.html">Vertex buffers</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../04_Vertex_buffers/00_Vertex_input_description.html">Vertex input description</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../04_Vertex_buffers/01_Vertex_buffer_creation.html">Vertex buffer creation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../04_Vertex_buffers/02_Staging_buffer.html">Staging buffer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../04_Vertex_buffers/03_Index_buffer.html">Index buffer</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../05_Uniform_buffers/00_Descriptor_set_layout_and_buffer.html">Uniform buffers</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../05_Uniform_buffers/00_Descriptor_set_layout_and_buffer.html">Descriptor layout and buffer</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../05_Uniform_buffers/01_Descriptor_pool_and_sets.html">Descriptor pool and sets</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../06_Texture_mapping/00_Images.html">Texture mapping</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../06_Texture_mapping/00_Images.html">Images</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../06_Texture_mapping/01_Image_view_and_sampler.html">Image view and sampler</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../06_Texture_mapping/02_Combined_image_sampler.html">Combined image sampler</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../07_Depth_buffering.html">Depth buffering</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../08_Loading_models.html">Loading models</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../09_Generating_Mipmaps.html">Generating Mipmaps</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../10_Multisampling.html">Multisampling</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../11_Compute_Shader.html">Compute Shader</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../12_Ecosystem_Utilities_and_Compatibility.html">Ecosystem Utilities and GPU Compatibility</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../13_Vulkan_Profiles.html">Vulkan Profiles</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../14_Android.html">Android</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../15_GLTF_KTX2_Migration.html">Migrating to Modern Asset Formats: glTF and KTX2</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../16_Multiple_Objects.html">Rendering Multiple Objects</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../17_Multithreading.html">Multithreading</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../../courses/18_Ray_tracing/00_Overview.html">Ray Tracing</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../courses/18_Ray_tracing/00_Overview.html">Overview</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../courses/18_Ray_tracing/01_Dynamic_rendering.html">Dynamic rendering</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../courses/18_Ray_tracing/02_Acceleration_structures.html">Acceleration structures</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../courses/18_Ray_tracing/03_Ray_query_shadows.html">Ray query shadows</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../courses/18_Ray_tracing/04_TLAS_animation.html">TLAS animation</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../courses/18_Ray_tracing/05_Shadow_transparency.html">Shadow transparency</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../courses/18_Ray_tracing/06_Reflections.html">Reflections</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../../courses/18_Ray_tracing/07_Conclusion.html">Conclusion</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../../90_FAQ.html">FAQ</a>
  </li>
  <li class="nav-item" data-depth="1">
    <span class="nav-text"><a href="https://github.com/KhronosGroup/Vulkan-Tutorial" target="_blank" rel="noopener">GitHub Repository</a></span>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Khronos Vulkan Tutorial</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <a class="title" href="../../00_Introduction.html">Khronos Vulkan Tutorial</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../../00_Introduction.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../glsl/latest/index.html">OpenGL Shading Language Specification</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../glsl/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../refpages/latest/refpages/index.html">Vulkan API Reference Pages</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../refpages/latest/refpages/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../features/latest/features/index.html">Vulkan Feature Descriptions</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../features/latest/features/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../guide/latest/index.html">Vulkan Guide</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../guide/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../samples/latest/README.html">Vulkan Samples</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../samples/latest/README.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../../spec/latest/index.html">Vulkan Specification</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../../spec/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../../../spec/latest/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../../00_Introduction.html">Khronos Vulkan Tutorial</a></li>
    <li><a href="03_debugging_and_renderdoc.html">Tooling: Debugging with VK_KHR_debug_utils and RenderDoc</a></li>
  </ul>
</nav>
    <!--
    -->
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Tooling: Debugging with VK_KHR_debug_utils and RenderDoc</h1>
<div class="sect1">
<h2 id="_debugging_vulkan_applications"><a class="anchor" href="#_debugging_vulkan_applications"></a>Debugging Vulkan Applications</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Debugging graphics applications can be challenging due to their complex, parallel nature and the fact that much of the processing happens on the GPU. Vulkan, with its explicit design, provides powerful debugging tools that can help identify and fix issues in your application. In this section, we&#8217;ll explore two key approaches to debugging Vulkan applications:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Using the VK_KHR_debug_utils extension for in-application debugging</p>
</li>
<li>
<p>Using external tools like RenderDoc for frame capture and analysis</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_using_vk_khr_debug_utils"><a class="anchor" href="#_using_vk_khr_debug_utils"></a>Using VK_KHR_debug_utils</h3>
<div class="paragraph">
<p>The VK_KHR_debug_utils extension provides a comprehensive set of tools for debugging Vulkan applications. It allows you to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Label objects with meaningful names</p>
</li>
<li>
<p>Mark the beginning and end of command buffer regions</p>
</li>
<li>
<p>Insert debug markers</p>
</li>
<li>
<p>Set up debug messengers to receive validation layer messages</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s explore how to use these features with C++20 modules and vk::raii.</p>
</div>
<div class="sect3">
<h4 id="_setting_up_debug_messaging"><a class="anchor" href="#_setting_up_debug_messaging"></a>Setting Up Debug Messaging</h4>
<div class="paragraph">
<p>First, let&#8217;s set up a debug messenger to receive validation layer messages:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">import std;
import vulkan_raii;

// Debug callback function
VKAPI_ATTR VkBool32 VKAPI_CALL debug_callback(
    VkDebugUtilsMessageSeverityFlagBitsEXT message_severity,
    VkDebugUtilsMessageTypeFlagsEXT message_type,
    const VkDebugUtilsMessengerCallbackDataEXT* callback_data,
    void* user_data) {

    // Convert severity to string
    std::string severity;
    if (message_severity &amp; VK_DEBUG_UTILS_MESSAGE_SEVERITY_VERBOSE_BIT_EXT) {
        severity = "VERBOSE";
    } else if (message_severity &amp; VK_DEBUG_UTILS_MESSAGE_SEVERITY_INFO_BIT_EXT) {
        severity = "INFO";
    } else if (message_severity &amp; VK_DEBUG_UTILS_MESSAGE_SEVERITY_WARNING_BIT_EXT) {
        severity = "WARNING";
    } else if (message_severity &amp; VK_DEBUG_UTILS_MESSAGE_SEVERITY_ERROR_BIT_EXT) {
        severity = "ERROR";
    }

    // Convert type to string
    std::string type;
    if (message_type &amp; VK_DEBUG_UTILS_MESSAGE_TYPE_GENERAL_BIT_EXT) {
        type = "GENERAL";
    } else if (message_type &amp; VK_DEBUG_UTILS_MESSAGE_TYPE_VALIDATION_BIT_EXT) {
        type = "VALIDATION";
    } else if (message_type &amp; VK_DEBUG_UTILS_MESSAGE_TYPE_PERFORMANCE_BIT_EXT) {
        type = "PERFORMANCE";
    }

    // Log the message
    std::cerr &lt;&lt; "[" &lt;&lt; severity &lt;&lt; ": " &lt;&lt; type &lt;&lt; "] "
              &lt;&lt; callback_data-&gt;pMessage &lt;&lt; std::endl;

    // Return false to indicate the Vulkan call should not be aborted
    return VK_FALSE;
}

// Create a debug messenger using vk::raii
vk::raii::DebugUtilsMessengerEXT create_debug_messenger(vk::raii::Instance&amp; instance) {
    vk::DebugUtilsMessengerCreateInfoEXT create_info{};
    create_info.setMessageSeverity(
        vk::DebugUtilsMessageSeverityFlagBitsEXT::eVerbose |
        vk::DebugUtilsMessageSeverityFlagBitsEXT::eInfo |
        vk::DebugUtilsMessageSeverityFlagBitsEXT::eWarning |
        vk::DebugUtilsMessageSeverityFlagBitsEXT::eError
    );
    create_info.setMessageType(
        vk::DebugUtilsMessageTypeFlagBitsEXT::eGeneral |
        vk::DebugUtilsMessageTypeFlagBitsEXT::eValidation |
        vk::DebugUtilsMessageTypeFlagBitsEXT::ePerformance
    );
    create_info.setPfnUserCallback(debug_callback);

    return vk::raii::DebugUtilsMessengerEXT(instance, create_info);
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_object_naming"><a class="anchor" href="#_object_naming"></a>Object Naming</h4>
<div class="paragraph">
<p>One of the most useful features of VK_KHR_debug_utils is the ability to give meaningful names to Vulkan objects. This makes debugging much easier, as you can identify objects in validation layer messages and tools like RenderDoc:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">// Helper function to set a name on any Vulkan handle
template&lt;typename T&gt;
void set_object_name(vk::raii::Device&amp; device, T handle, const std::string&amp; name) {
    vk::DebugUtilsObjectNameInfoEXT name_info{};
    name_info.setObjectType(get_object_type&lt;T&gt;());
    name_info.setObjectHandle(reinterpret_cast&lt;uint64_t&gt;(static_cast&lt;T&gt;(handle)));
    name_info.setPObjectName(name.c_str());

    device.setDebugUtilsObjectNameEXT(name_info);
}

// Example usage
void name_vulkan_objects(vk::raii::Device&amp; device) {
    // Name the device itself
    set_object_name(device, *device, "Main Device");

    // Name a buffer
    vk::BufferCreateInfo buffer_info{};
    // ... set buffer creation parameters
    vk::raii::Buffer buffer(device, buffer_info);
    set_object_name(device, *buffer, "Vertex Buffer");

    // Name a pipeline
    vk::raii::Pipeline pipeline = create_graphics_pipeline(device);
    set_object_name(device, *pipeline, "Main Render Pipeline");
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_command_buffer_labeling"><a class="anchor" href="#_command_buffer_labeling"></a>Command Buffer Labeling</h4>
<div class="paragraph">
<p>You can also label regions of command buffer execution, which helps identify where issues occur during rendering:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">void record_command_buffer(vk::raii::CommandBuffer&amp; cmd_buffer) {
    cmd_buffer.begin({vk::CommandBufferUsageFlagBits::eOneTimeSubmit});

    // Begin a labeled region
    vk::DebugUtilsLabelEXT label_info{};
    label_info.setPLabelName("Shadow Pass");
    label_info.setColor(std::array&lt;float, 4&gt;{0.0f, 0.0f, 0.0f, 1.0f}); // Black for shadow pass
    cmd_buffer.beginDebugUtilsLabelEXT(label_info);

    // Record shadow pass commands
    // ...

    // End the labeled region
    cmd_buffer.endDebugUtilsLabelEXT();

    // Begin another labeled region
    label_info.setPLabelName("Main Render Pass");
    label_info.setColor(std::array&lt;float, 4&gt;{0.0f, 1.0f, 0.0f, 1.0f}); // Green for main pass
    cmd_buffer.beginDebugUtilsLabelEXT(label_info);

    // Record main render pass commands
    // ...

    // Insert a marker within this region
    cmd_buffer.insertDebugUtilsLabelEXT({
        "Drawing Opaque Objects",
        std::array&lt;float, 4&gt;{1.0f, 1.0f, 1.0f, 1.0f}
    });

    // More rendering commands
    // ...

    // End the labeled region
    cmd_buffer.endDebugUtilsLabelEXT();

    cmd_buffer.end();
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_queue_labeling"><a class="anchor" href="#_queue_labeling"></a>Queue Labeling</h4>
<div class="paragraph">
<p>Similarly, you can label operations submitted to a queue:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">void submit_work(vk::raii::Queue&amp; queue, vk::raii::CommandBuffer&amp; cmd_buffer) {
    // Begin a labeled region for the queue submission
    vk::DebugUtilsLabelEXT label_info{};
    label_info.setPLabelName("Frame Rendering");
    label_info.setColor(std::array&lt;float, 4&gt;{0.0f, 0.5f, 1.0f, 1.0f}); // Blue for frame
    queue.beginDebugUtilsLabelEXT(label_info);

    // Submit the command buffer
    vk::SubmitInfo submit_info{};
    submit_info.setCommandBufferCount(1);
    submit_info.setPCommandBuffers(&amp;(*cmd_buffer));
    queue.submit(submit_info, nullptr);

    // End the labeled region
    queue.endDebugUtilsLabelEXT();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_renderdoc"><a class="anchor" href="#_using_renderdoc"></a>Using RenderDoc</h3>
<div class="paragraph">
<p>RenderDoc is a graphics frame debugger and capture/analysis tool (not a compiler). It allows you to capture frames from your application and analyze them in detail. It&#8217;s particularly useful for Vulkan applications due to its comprehensive support for the API.</p>
</div>
<div class="sect3">
<h4 id="_integrating_renderdoc_with_your_application"><a class="anchor" href="#_integrating_renderdoc_with_your_application"></a>Integrating RenderDoc with Your Application</h4>
<div class="paragraph">
<p>You can integrate RenderDoc directly into your application using its in-application API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">import std;
import vulkan_raii;

#include &lt;renderdoc_app.h&gt;

// Load the RenderDoc API
RENDERDOC_API_1_4_1* renderdoc_api = nullptr;

bool load_renderdoc_api() {
    #if defined(_WIN32)
    HMODULE renderdoc_module = LoadLibraryA("renderdoc.dll");
    #else
    void* renderdoc_module = dlopen("librenderdoc.so", RTLD_NOW | RTLD_NOLOAD);
    #endif

    if (!renderdoc_module) {
        std::cerr &lt;&lt; "RenderDoc not loaded in this application" &lt;&lt; std::endl;
        return false;
    }

    #if defined(_WIN32)
    pRENDERDOC_GetAPI get_api = (pRENDERDOC_GetAPI)GetProcAddress(renderdoc_module, "RENDERDOC_GetAPI");
    #else
    pRENDERDOC_GetAPI get_api = (pRENDERDOC_GetAPI)dlsym(renderdoc_module, "RENDERDOC_GetAPI");
    #endif

    if (!get_api) {
        std::cerr &lt;&lt; "Failed to get RenderDoc API function" &lt;&lt; std::endl;
        return false;
    }

    int ret = get_api(eRENDERDOC_API_Version_1_4_1, (void**)&amp;renderdoc_api);
    if (ret != 1) {
        std::cerr &lt;&lt; "Failed to initialize RenderDoc API" &lt;&lt; std::endl;
        return false;
    }

    std::cout &lt;&lt; "RenderDoc API initialized successfully" &lt;&lt; std::endl;
    return true;
}

// Trigger a capture
void capture_frame() {
    if (renderdoc_api) {
        renderdoc_api-&gt;TriggerCapture();
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_analyzing_captures"><a class="anchor" href="#_analyzing_captures"></a>Analyzing Captures</h4>
<div class="paragraph">
<p>Once you&#8217;ve captured a frame, you can analyze it in the RenderDoc application. Here are some key features to look for:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Pipeline State</strong>: Examine the full graphics pipeline state for each draw call</p>
</li>
<li>
<p><strong>Resource Inspection</strong>: View the contents of buffers, textures, and other resources</p>
</li>
<li>
<p><strong>Shader Debugging</strong>: Step through shader execution for specific pixels</p>
</li>
<li>
<p><strong>Timing Information</strong>: Analyze performance of different parts of your frame</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_best_practices_for_renderdoc"><a class="anchor" href="#_best_practices_for_renderdoc"></a>Best Practices for RenderDoc</h4>
<div class="paragraph">
<p>To get the most out of RenderDoc:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Use Object Names</strong>: As discussed earlier, naming your Vulkan objects makes them much easier to identify in RenderDoc (you&#8217;ll see them in the Resource Inspector and Pipeline State views).</p>
</li>
<li>
<p><strong>Use Command Buffer Labels</strong>: These appear in RenderDoc&#8217;s Event Browser and help you navigate to the relevant draw/dispatch quickly.</p>
</li>
<li>
<p><strong>Capture the Problem Frame</strong>: Trigger a capture exactly when the issue occurs (via hotkey or the in-application API) to minimize unrelated events and noise.</p>
</li>
<li>
<p><strong>Minimize to a Repro</strong>: Create a minimal reproducible scene or toggle features off to isolate the problem. If you reduce resolution, make sure it doesn&#8217;t alter ordering/timing in a way that hides the bug.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_combining_vk_khr_debug_utils_and_renderdoc"><a class="anchor" href="#_combining_vk_khr_debug_utils_and_renderdoc"></a>Combining VK_KHR_debug_utils and RenderDoc</h3>
<div class="paragraph">
<p>The real power comes from combining these approaches:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Use VK_KHR_debug_utils to add rich debugging information to your application</p>
</li>
<li>
<p>Use RenderDoc to capture and analyze frames with this information</p>
</li>
<li>
<p>Use validation layers to catch API usage errors</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Here&#8217;s an example of setting up a debugging environment that combines these approaches:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-cpp hljs" data-lang="cpp">import std;
import vulkan_raii;

class DebugManager {
public:
    DebugManager() {
        // Try to load RenderDoc API
        load_renderdoc_api();
    }

    void setup_instance_debugging(vk::raii::Context&amp; context, vk::InstanceCreateInfo&amp; create_info) {
        // Add validation layers
        std::vector&lt;const char*&gt; validation_layers = {"VK_LAYER_KHRONOS_validation"};
        create_info.setPEnabledLayerNames(validation_layers);

        // Add debug utils extension
        std::vector&lt;const char*&gt; extensions = {VK_EXT_DEBUG_UTILS_EXTENSION_NAME};
        // Add any existing extensions
        if (create_info.enabledExtensionCount &gt; 0) {
            for (uint32_t i = 0; i &lt; create_info.enabledExtensionCount; i++) {
                extensions.push_back(create_info.ppEnabledExtensionNames[i]);
            }
        }
        create_info.setPEnabledExtensionNames(extensions);

        // Store debug messenger create info for instance creation
        debug_create_info.setMessageSeverity(
            vk::DebugUtilsMessageSeverityFlagBitsEXT::eVerbose |
            vk::DebugUtilsMessageSeverityFlagBitsEXT::eInfo |
            vk::DebugUtilsMessageSeverityFlagBitsEXT::eWarning |
            vk::DebugUtilsMessageSeverityFlagBitsEXT::eError
        );
        debug_create_info.setMessageType(
            vk::DebugUtilsMessageTypeFlagBitsEXT::eGeneral |
            vk::DebugUtilsMessageTypeFlagBitsEXT::eValidation |
            vk::DebugUtilsMessageTypeFlagBitsEXT::ePerformance
        );
        debug_create_info.setPfnUserCallback(debug_callback);

        // Add to pNext chain
        debug_create_info.pNext = create_info.pNext;
        create_info.pNext = &amp;debug_create_info;
    }

    void setup_debug_messenger(vk::raii::Instance&amp; instance) {
        debug_messenger = vk::raii::DebugUtilsMessengerEXT(instance, debug_create_info);
    }

    template&lt;typename T&gt;
    void set_name(vk::raii::Device&amp; device, T handle, const std::string&amp; name) {
        try {
            vk::DebugUtilsObjectNameInfoEXT name_info{};
            name_info.setObjectType(get_object_type&lt;T&gt;());
            name_info.setObjectHandle(reinterpret_cast&lt;uint64_t&gt;(static_cast&lt;T&gt;(handle)));
            name_info.setPObjectName(name.c_str());

            device.setDebugUtilsObjectNameEXT(name_info);
        } catch (vk::SystemError&amp; err) {
            std::cerr &lt;&lt; "Failed to set object name: " &lt;&lt; err.what() &lt;&lt; std::endl;
        }
    }

    void capture_next_frame() {
        if (renderdoc_api) {
            renderdoc_api-&gt;TriggerCapture();
        }
    }

private:
    vk::DebugUtilsMessengerCreateInfoEXT debug_create_info{};
    vk::raii::DebugUtilsMessengerEXT debug_messenger{nullptr};
    RENDERDOC_API_1_4_1* renderdoc_api = nullptr;
};</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_conclusion"><a class="anchor" href="#_conclusion"></a>Conclusion</h3>
<div class="paragraph">
<p>Effective debugging is essential for developing complex Vulkan applications. By combining the power of VK_KHR_debug_utils for in-application debugging and RenderDoc for frame capture and analysis, you can quickly identify and fix issues in your rendering pipeline.</p>
</div>
<div class="paragraph">
<p>In the next section, we&#8217;ll explore crash handling and minidumps, which are crucial for diagnosing issues that occur in production environments.</p>
</div>
<div class="paragraph">
<p><a href="02_cicd.adoc">Previous: CI/CD for Vulkan Projects</a> | <a href="04_crash_minidump.adoc">Next: Crash Handling and Minidumps</a></p>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
    <!--
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
    -->
</footer>
<script id="site-script" src="../../../../_/js/site.js" data-ui-root-path="../../../../_"></script>
<script async src="../../../../_/js/vendor/highlight.js"></script>
<script src="../../../../_/js/vendor/lunr.js" defer></script>
<script src="https://cdn.jsdelivr.net/pako/1.0.3/pako.min.js" defer></script>
<script src="../../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../../.." data-snippet-length="100" data-stylesheet="../../../../_/css/search.css" defer></script>
<script>
window.addEventListener('DOMContentLoaded', function(){
  try {
    var script = document.getElementById('search-ui-script');
    var siteRoot = (script && script.getAttribute('data-site-root-path')) || '';
    var manifestUrl = siteRoot + '/search-index/manifest.json';
    fetch(manifestUrl)
      .then(function (r) { return r.ok ? r.json() : Promise.reject(new Error('manifest not found')) })
      .then(function (manifest) { antoraSearch.bootstrap(lunr, manifest, siteRoot); })
      .catch(function () {
        var s = document.createElement('script');
        s.async = true;
        s.src = siteRoot + '/search-index.js';
        document.head.appendChild(s);
      });
  } catch (e) {
    // Fallback to monolithic index if anything goes wrong
    var s = document.createElement('script');
    s.async = true;
    s.src = '../../../../search-index.js';
    document.head.appendChild(s);
  }
});
</script>
  </body>
</html>
